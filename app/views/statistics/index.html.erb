<div class="statistics">
  <div class="generic-table--container">
    <div class="generic-table--results-container">
      <table class="generic-table" id="user_statistics">
        <colgroup>
          <col highlight-col>
          <col highlight-col>
          <col highlight-col>
          <col highlight-col>
        </colgroup>
        <thead>
        <tr>
          <th>
            <div class="generic-table--sort-header-outer">
              <div class="generic-table--sort-header">
                <span>
                  <%= l('attributes.type') %>
                </span>
              </div>
            </div>
          </th>
          <th>
            <div class="generic-table--sort-header-outer">
              <div class="generic-table--sort-header">
                <span>
                  <%= l('attributes.name') %>
                </span>
              </div>
            </div>
          </th>
          <th>
            <div class="generic-table--sort-header-outer">
              <div class="generic-table--sort-header">
                <span>
                  <%= l('attributes.date') %>
                </span>
              </div>
            </div>
          </th>
          <th>
            <div class="generic-table--sort-header-outer">
              <div class="generic-table--sort-header">
                <span>
                  <%= l('attributes.time') %>
                </span>
              </div>
            </div>
          </th>
        </tr>
        </thead>
        <tbody>
        <% @statistics.each do |stat| %>
          <% if stat.project == @project %>
            <tr id="statistics-<%= stat.id %>">
              <td>
                <% if stat.version == 1 %>
                  <%= t("text_project_created_"+stat.journable_type.to_s.downcase) %>
                <%elsif stat.version > 1 %>
                  <% if stat.journable_type == "WorkPackage" && WorkPackageJournal.where(journal_id: stat.id).first.done_ratio == 100 && WorkPackageJournal.where(journal_id: Journal.where(journable_id: stat.journable_id, version: stat.version - 1)).first.done_ratio <100%>
                    <%=  t('text_user_done_wp') %>
                    <%# elsif stat.journable_type == "WorkPackage" && WorkPackageJournal.where(journal_id: stat.id).first.due_date < Date.current %>
                    <%#=  t('text_user_overdue_wp') %>
                  <% else %>
                    <%= t("text_project_updated_"+stat.journable_type.to_s.downcase) %>
                  <% end %>
                <% else %>
                  <%= stat.journable_type %>
                <% end %>
              </td>
              <td>
                <% if stat.journable_type == "WorkPackage"%>
                  <%= WorkPackageJournal.where(journal_id: stat.id).first.subject %>
                <% elsif stat.journable_type == "NationalProject"%>
                  <%= NationalProjectJournal.where(journal_id: stat.id).first.name %>
                <% elsif stat.journable_type == "Message"%>
                  <%= MessageJournal.where(journal_id: stat.id).first.content%>
                <% elsif stat.journable_type == "Document"%>
                  <%= DocumentJournal.where(journal_id: stat.id).first.title%>
                <% else %>
                  <%= stat.journable_id %>
                <% end %>
              </td>
              <td>
                <%= format_activity_day(stat.created_at) %>
              </td>
              <td>
                <%= format_time(stat.created_at,false) %>
              </td>
            </tr>
          <% end  %>
        <% end %>
        </tbody>
      </table>
    </div>
  </div>
  <%= pagination_links_full @statistics %>
</div>
<%= call_hook :view_account_left_bottom, user: @user %>



