<div class="statistics">
  <div class="generic-table--container">
    <div class="generic-table--results-container">
      <table class="generic-table" id="user_statistics">
        <colgroup>
          <col highlight-col>
          <col highlight-col>
          <col highlight-col>
          <col highlight-col>
        </colgroup>
        <thead>
        <tr>
          <th>
            <div class="generic-table--sort-header-outer">
              <div class="generic-table--sort-header">
                <span>
                  <%= l('attributes.type') %>
                </span>
              </div>
            </div>
          </th>
          <th>
            <div class="generic-table--sort-header-outer">
              <div class="generic-table--sort-header">
                <span>
                  <%= l('attributes.name') %>
                </span>
              </div>
            </div>
          </th>
          <th>
            <div class="generic-table--sort-header-outer">
              <div class="generic-table--sort-header">
                <span>
                  <%= l('attributes.date') %>
                </span>
              </div>
            </div>
          </th>
          <th>
            <div class="generic-table--sort-header-outer">
              <div class="generic-table--sort-header">
                <span>
                  <%= l('attributes.time') %>
                </span>
              </div>
            </div>
          </th>
        </tr>
        </thead>
        <tbody>
        <% @statistics.each do |stat| %>
        <tr id="statistics-<%= stat.id %>">
          <td>
            <% if stat.version == 1 %>
              <%= t("text_user_created_"+stat.journable_type.to_s.downcase) %>
            <%elsif stat.version > 1 %>
              <% if stat.journable_type == "WorkPackage" && WorkPackageJournal.where(journal_id: stat.id).first.done_ratio == 100 && WorkPackageJournal.where(journal_id: Journal.where(journable_id: stat.journable_id, version: stat.version - 1)).first.done_ratio <100%>
                <%=  t('text_user_done_wp') %>
              <%# elsif stat.journable_type == "WorkPackage" && WorkPackageJournal.where(journal_id: stat.id).first.due_date < Date.current %>
                <%#=  t('text_user_overdue_wp') %>
              <% else %>
                <%= t("text_user_updated_"+stat.journable_type.to_s.downcase) %>
              <% end %>
            <% else %>
              <%= stat.journable_type %>
            <% end %>
          </td>
          <td>
            <% if stat.journable_type == "WorkPackage"%>
              <%= WorkPackageJournal.where(journal_id: stat.id).first.subject %>
            <% elsif stat.journable_type == "NationalProject"%>
              <%= NationalProjectJournal.where(journal_id: stat.id).first.name %>
            <% elsif stat.journable_type == "Message"%>
              <%= MessageJournal.where(journal_id: stat.id).first.content%>
            <% elsif stat.journable_type == "Document"%>
              <%= DocumentJournal.where(journal_id: stat.id).first.title%>
            <% else %>
              <%= stat.journable_id %>
            <% end %>
          </td>
          <td>
            <%= format_activity_day(stat.created_at) %>
          </td>
          <td>
            <%= format_time(stat.created_at,false) %>
          </td>
        </tr>
        <% end %>
        <%# for stat in @statistics["wp_appointment"] %>
<!--          <tr id="wp_created" class="hide-section">-->
<!--            <td>-->
<!--              <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
              <%# if stat.assigned_to_id == @user.id %>
                <%#=  l(:text_user_assigned_to_wp)%>
              <%# elsif  stat.responsible_id == @user.id%>
                <%#=  l(:text_user_responsible_to_wp) %>
<!--              <%# end %></td>-->
<!--            <td>-->
              <%#= stat.subject %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_activity_day(Journal.find(stat.journal_id).created_at) %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--            </td>-->
<!--          </tr>-->
        <%# end %>
        <%# for stat in @statistics["wp_created"] %>
<!--          <tr id="wp_created" class="hide-section">-->
<!--            <td>-->
<!--              <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
              <%#=  l(:text_user_created_wp)%>
<!--            </td>-->
<!--            <td>-->
              <%#= stat.subject %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_activity_day(Journal.find(stat.journal_id).created_at) %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--            </td>-->
<!--          </tr>-->
        <%# end %>
        <%# for stat in @statistics["wp_overdue"] %>
<!--        <tr id="wp_overdue" class="hide-section">-->
<!--          <td>-->
<!--            <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
            <%#=  l(:text_user_overdue_wp)%>
<!--          </td>-->
<!--          <td>-->
            <%#= stat.subject %>
<!--          </td>-->
<!--          <td>-->
            <%#= format_activity_day(Journal.find(stat.journal_id).created_at)  %>
<!--          </td>-->
<!--          <td>-->
            <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--          </td>-->
<!--        </tr>-->
        <%# end %>
        <%# for stat in @statistics["wp_done"] %>
<!--        <tr id="wp_overdue" class="hide-section">-->
<!--          <td>-->
<!--            <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
            <%#=  l(:text_user_done_wp)%>
<!--          </td>-->
<!--          <td>-->
            <%#= stat.subject %>
<!--          </td>-->
<!--          <td>-->
            <%#= format_activity_day(Journal.find(stat.journal_id).created_at)  %>
<!--          </td>-->
<!--          <td>-->
            <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--          </td>-->
<!--        </tr>-->
        <%# end %>
        <%# for stat in @statistics["doc_created"] %>
<!--          <tr id="doc_created" class="hide-section">-->
<!--            <td>-->
<!--              <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
              <%#=  l(:text_user_added_doc)%>
<!--            </td>-->
<!--            <td>-->
              <%#= stat.title %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_activity_day(Journal.find(stat.journal_id).created_at)  %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--            </td>-->
<!--          </tr>-->
        <%# end %>
        <%# for stat in @statistics["doc_updated"] %>
<!--          <tr id="doc_updated" class="hide-section">-->
<!--            <td>-->
<!--              <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
              <%#=  l(:text_user_updated_doc)%>
<!--            </td>-->
<!--            <td>-->
              <%#= stat.title %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_activity_day(Journal.find(stat.journal_id).created_at)  %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--            </td>-->
<!--          </tr>-->
        <%# end %>
        <%# for stat in @statistics["board_messaged"] %>
<!--          <tr id="board_messaged" class="hide-section">-->
<!--            <td>-->
<!--              <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
              <%#=  l(:text_user_messaged_board)%>
<!--            </td>-->
<!--            <td>-->
<!--              <b><%#= stat.subject%></b>: <%#= stat.content %>-->
<!--            </td>-->
<!--            <td>-->
              <%#= format_activity_day(Journal.find(stat.journal_id).created_at)  %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--            </td>-->
<!--          </tr>-->
        <%# end %>
        <%# for stat in @statistics["message_updated"] %>
<!--          <tr id="message_updated" class="hide-section">-->
<!--            <td>-->
<!--              <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
              <%#=  l(:text_user_updated_message)%>
<!--            </td>-->
<!--            <td>-->
<!--              <b><%#= stat.subject%></b>: <%#= stat.content %>-->
<!--            </td>-->
<!--            <td>-->
              <%#= format_activity_day(Journal.find(stat.journal_id).created_at)  %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--            </td>-->
<!--          </tr>-->
        <%# end %>
        <%# for stat in @statistics["np_created"] %>
<!--          <tr id="np_created" class="hide-section">-->
<!--            <td>-->
<!--              <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
              <%#=  l(:text_user_created_np, t("activerecord.attributes.national_project."+stat.type.downcase))%>
<!--            </td>-->
<!--            <td>-->
              <%#= stat.name %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_activity_day(Journal.find(stat.journal_id).created_at)  %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--            </td>-->
<!--          </tr>-->
        <%# end %>
        <%# for stat in @statistics["np_updated"] %>
<!--          <tr id="np_updated" class="hide-section">-->
<!--            <td>-->
<!--              <span class="wp-table--hierarchy-span" style="width:45px;"></span>-->
              <%#=  l(:text_user_updated_np, NationalProject.human_attribute_name(stat.type))%>
<!--            </td>-->
<!--            <td>-->
              <%#= stat.name %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_activity_day(Journal.find(stat.journal_id).created_at)  %>
<!--            </td>-->
<!--            <td>-->
              <%#= format_time(Journal.find(stat.journal_id).created_at,false) %>
<!--            </td>-->
<!--          </tr>-->
        <%# end %>
        </tbody>
      </table>
    </div>
  </div>
  <%= pagination_links_full @statistics %>
</div>
<%= call_hook :view_account_left_bottom, user: @user %>



